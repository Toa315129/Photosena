<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sena Photobooth</title>

<!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå -->
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg, #fdfdfb, #e6f0eb);
  font-family: 'Cinzel', serif;
  text-align: center;
}

/* ‡∏Å‡∏£‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å */
#frame {
  width: 600px; /* 4x6 ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô */
  height: 900px;
  margin: 30px auto;
  border: 14px solid #fff;
  box-shadow: 0 0 30px rgba(0,0,0,0.3);
  background: #fff;
  position: relative;
  overflow: hidden;
  border-radius: 10px;
}

/* ‡∏´‡∏±‡∏ß‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
#frame h1 {
  font-family: 'Great Vibes', cursive;
  font-size: 60px;
  color: #145c3c;
  margin: 15px 0 0;
}
#frame h2 {
  font-size: 18px;
  color: #145c3c;
  margin: -10px 0 25px;
  letter-spacing: 2px;
}

/* ‡∏ä‡πà‡∏≠‡∏á‡∏†‡∏≤‡∏û */
.photo-box {
  width: 45%;
  height: 26%;
  border: 3px solid #145c3c;
  margin: 10px;
  background: #eee;
  display: inline-block;
  vertical-align: top;
  background-size: cover;
  background-position: center;
  box-shadow: inset 0 0 8px rgba(0,0,0,0.15);
  border-radius: 6px;
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á */
button {
  margin: 15px;
  padding: 15px 25px;
  font-size: 18px;
  background: radial-gradient(circle at top left, #2b7a4f, #145c3c);
  color: #fff;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  transition: transform 0.2s;
}
button:hover {
  transform: scale(1.05);
}

/* ‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á */
.star {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 60px;
  color: #1b7a52;
  opacity: 0.2;
}
.ribbon {
  position: absolute;
  bottom: 20px;
  right: 20px;
  font-size: 70px;
  color: #1b7a52;
  transform: rotate(15deg);
  opacity: 0.2;
}
.sparkle {
  position: absolute;
  top: 95px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 30px;
  color: #fff;
  text-shadow: 0 0 10px rgba(255,255,255,0.9);
}

/* ‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á */
#countdown {
  position: absolute;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 100px;
  color: #fff;
  text-shadow: 0 0 20px rgba(0,0,0,0.7);
  display: none;
  font-family: 'Cinzel', serif;
}

/* ‡πÅ‡∏ü‡∏•‡∏ä‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå */
#flash {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: white;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s;
  z-index: 999;
}
</style>
</head>
<body>

<div id="frame">
  <h1>Sena</h1>
  <h2>PHOTO BOOTH</h2>
  
  <!-- 6 ‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏π‡∏õ -->
  <div class="photo-box" id="p1"></div>
  <div class="photo-box" id="p2"></div><br>
  <div class="photo-box" id="p3"></div>
  <div class="photo-box" id="p4"></div><br>
  <div class="photo-box" id="p5"></div>
  <div class="photo-box" id="p6"></div>
  
  <!-- ‡∏Å‡∏£‡∏≠‡∏ö‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á -->
  <div class="star">‚òÖ</div>
  <div class="ribbon">‚ûø</div>
  <div class="sparkle">‚ú¶</div>
  
  <!-- ‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á -->
  <div id="countdown"></div>
</div>

<div>
  <button onclick="startBooth()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
  <button onclick="download()">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</button>
</div>

<div id="flash"></div>

<script>
let taking = false;

function showCountdown(num) {
  return new Promise((resolve) => {
    const countdown = document.getElementById("countdown");
    countdown.style.display = "block";
    let current = num;

    const interval = setInterval(() => {
      countdown.textContent = current;
      current--;

      if (current < 0) {
        clearInterval(interval);
        countdown.style.display = "none";
        resolve();
      }
    }, 1000);
  });
}

function flashEffect() {
  const flash = document.getElementById("flash");
  flash.style.opacity = 1;
  setTimeout(() => flash.style.opacity = 0, 300);
}

function capturePhoto(slot) {
  return new Promise((resolve) => {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        let video = document.createElement("video");
        video.srcObject = stream;
        video.play();

        setTimeout(() => {
          let canvas = document.createElement("canvas");
          canvas.width = 400;
          canvas.height = 300;
          let ctx = canvas.getContext("2d");
          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
          document.getElementById(slot).style.backgroundImage = "url(" + canvas.toDataURL("image/png") + ")";
          stream.getTracks().forEach(track => track.stop());
          flashEffect();
          resolve();
        }, 500);
      });
  });
}

async function startBooth() {
  if (taking) return;
  taking = true;

  for (let i = 1; i <= 6; i++) {
    await showCountdown(3);       // ‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á 3..2..1
    await capturePhoto("p" + i);  // ‡∏ñ‡πà‡∏≤‡∏¢
    await new Promise(r => setTimeout(r, 1000)); // ‡πÄ‡∏ß‡πâ‡∏ô 1 ‡∏ß‡∏¥
  }

  taking = false;
}

function download(){
  html2canvas(document.querySelector("#frame")).then(canvas => {
    let link = document.createElement("a");
    link.download = "sena_photobooth.png";
    link.href = canvas.toDataURL();
    link.click();
  });
}
</script>

<!-- ‡πÇ‡∏´‡∏•‡∏î html2canvas -->
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

</body>
</html>
